openapi: "3.1.0"
info:
  title: "Product Search API"
  description: |
    API for the Product Search GPT.
    Search and browse an e-commerce product catalog.
    Supports filtering by category and price range.
  version: "1.0.0"

servers:
  - url: "https://your-app.vercel.app"
    description: "Production (Vercel)"

paths:
  /api/search:
    get:
      operationId: searchProducts
      summary: "Search the product catalog"
      description: |
        Search for products matching the user's query.
        Call this when the user wants to find, browse, filter, or look for products.
        Supports keyword search, category filtering, and price range filtering.
      parameters:
        - name: q
          in: query
          required: true
          schema:
            type: string
          description: |
            Search keywords from the user's message.
            Extract the main product name or category.
            Examples: "red shoes", "laptop under $500", "organic coffee"
        - name: category
          in: query
          required: false
          schema:
            type: string
            enum: ["electronics", "clothing", "food", "books"]
          description: "Filter by category. Only include if user explicitly mentions a category."
        - name: max_price
          in: query
          required: false
          schema:
            type: number
          description: "Maximum price in USD. Only include if user specifies a budget."
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 5
            maximum: 20
          description: "Number of results. Default 5. Increase if user asks for more."
      responses:
        "200":
          description: "Search results"
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        name:
                          type: string
                          description: "Product name — display to user"
                        description:
                          type: string
                        price:
                          type: number
                          description: "Price in USD — format as currency"
                        url:
                          type: string
                          description: "Product link — include for user to click"
                  total_count:
                    type: integer
                  message:
                    type: string
                    description: "Summary message — include in response"
        "400":
          description: "Invalid request"
        "401":
          description: "Authentication failed"

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key

security:
  - ApiKeyAuth: []
